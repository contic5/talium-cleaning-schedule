(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function l(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=l(e);fetch(e.href,o)}})();const g="AIzaSyCAYyVQq7KCgTqcXN9pcpCJ9T3PnvtlT9g",y="1--4Wi2IodFN67CIhpB9wW1SPU53hHsE-zmuFeBoOiNs",L="Sheet1";async function b(){let l=await(await(await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${y}/values/${L}?key=${g}`)).json()).values;console.log(l);let t=await C(l),e=await v(t);console.log(e),E(e)}function u(n){let r=n.substring(0,1);return r=r.toUpperCase(),r+n.substring(1)}async function C(n){let r=[],l=[];for(let t=0;t<n[0].length;t++)l.push(n[0][t]);for(let t=1;t<n.length;t++){let e={};for(let o=0;o<n[t].length;o++)e[l[o]]=n[t][o];r.push(e)}return r}async function v(n){for(let t=0;t<n.length;t++){let e=n[t].date.split("/");n[t].date_num=new Date(e[2],e[0]-1,e[1])}let r=new Date;return r=r.setDate(r.getDate()-1),console.log(n),n=n.filter(t=>t.date_num>=r),console.log(n),n[0]}async function E(n){let r=document.getElementById("results");r.innerHTML="";const l=["trash","mop","windex","bathroom"];let t=document.createElement("h1");r.appendChild(t),t.innerHTML=`Week Jobs for ${n.date}`;for(let e=0;e<l.length;e++){let o=l[e],s=u(l[(e+1)%l.length]),a=document.createElement("div");r.appendChild(a),a.classList.add("card"),a.style.maxWidth="500px";let i=document.createElement("div");a.appendChild(i),i.classList.add("card-body");let p=document.createElement("h2");i.appendChild(p),p.innerHTML=u(o);let f=document.createElement("ul");i.appendChild(f),i.classList.add("list-group");let m=n[o].split(",");for(let h of m){let d=document.createElement("li");f.appendChild(d),d.classList.add("list-group-item"),d.innerHTML=u(h)}let c=document.createElement("div");a.appendChild(c),c.classList.add("card-footer"),c.classList.add("text-body-secondary"),c.innerHTML=`Next Week: ${s}`}}b();
