(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function l(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(e){if(e.ep)return;e.ep=!0;const r=l(e);fetch(e.href,r)}})();const f="AIzaSyCAYyVQq7KCgTqcXN9pcpCJ9T3PnvtlT9g",m="1--4Wi2IodFN67CIhpB9wW1SPU53hHsE-zmuFeBoOiNs",h="Sheet1";async function g(){let l=await(await(await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${m}/values/${h}?key=${f}`)).json()).values;console.log(l);let t=await y(l),e=await L(t);console.log(e),C(e)}function d(n){let o=n.substring(0,1);return o=o.toUpperCase(),o+n.substring(1)}async function y(n){let o=[],l=[];for(let t=0;t<n[0].length;t++)l.push(n[0][t]);for(let t=1;t<n.length;t++){let e={};for(let r=0;r<n[t].length;r++)e[l[r]]=n[t][r];o.push(e)}return o}async function L(n){for(let t=0;t<n.length;t++){let e=n[t].date.split("/");n[t].date_num=new Date(e[2],e[0]-1,e[1])}let o=new Date;return o=o.setDate(o.getDate()-1),console.log(n),n=n.filter(t=>t.date_num>=o),console.log(n),n[0]}async function C(n){let o=document.getElementById("results");o.innerHTML="";const l=["trash","mop","windex","bathroom"];let t=document.createElement("h1");o.appendChild(t),t.innerHTML=`Week Jobs for ${n.date}`;for(let e of l){let r=document.createElement("div");o.appendChild(r),r.classList.add("card"),r.style.maxWidth="500px";let s=document.createElement("div");r.appendChild(s),s.classList.add("card-body");let a=document.createElement("h2");s.appendChild(a),a.innerHTML=d(e);let c=document.createElement("ul");s.appendChild(c),s.classList.add("list-group");let u=n[e].split(",");for(let p of u){let i=document.createElement("li");c.appendChild(i),i.classList.add("list-group-item"),i.innerHTML=d(p)}}}g();
